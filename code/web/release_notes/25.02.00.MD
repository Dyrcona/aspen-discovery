## Aspen LiDA Updates
//mark
### Account Updates
- When a library has multiple sublocations that are valid as pickup areas, allow the user to change the pickup area when changing the pickup location. (DIS-195) (*MDN*)

### Holds Updates
- When a library has multiple sublocations that are valid as pickup areas, allow the user to select a pickup area when placing a hold. (DIS-195) (*MDN*)
- When displaying a list of items to place a hold on, include item location and status to match the display within Aspen. (DIS-202) (*MDN*)
- When displaying holds for a patron, include the call number for the hold if available. (DIS-202) (*MDN*)
- When freezing holds, wait for all freeze operations to complete to show accurate results. (DIS-203) (*MDN*)
- If the title for a hold cannot be loaded, display "Title Not Available" to match Discovery. (DIS-203) (*MDN*)
- When freezing a hold (either single, selected, or all), do not show the calendar to select a thaw date if the ILS does not support reactivation dates. (DIS-204) (*MDN*)

### Search Updates
- Respect sort order for facets (Alphabetic or By Number of Results) when showing facet values within Aspen LiDA. (DIS-206) (*MDN*)

### Other Updates
- Display a popup message to patrons if app settings cannot be loaded when loading LiDA. (DIS-268) (*MDN*)
- When copying .env files during the build process, check for local .env files (prefixed by the slug). (DIS-270) (*MDN*)
- Pass app slug to Aspen Discovery as a header. (DIS-270) (*MDN*)

// kirstien

- On the Library Card screen, fixed a bug where 'Manage Alternate Library Card' button was displaying when the library
  did not have the feature enabled. (DIS-201) (*KK*)
- Add 'More Info' button at bottom of the Grouped Work screen to open up the grouped work in Aspen Discovery to provide
  the user with additional details. (DIS-207) (*KK*)

## Aspen Discovery Updates
//mark
### Account Profile Updates
- Properly show and hide fields within account profiles based on the selected ILS. (DIS-220) (*MDN*)
- Set the default weight for a new account profile and set the correct default driver and authentication type when changing the ILS. (DIS-220) (*MDN*)

### Administration Updates
- Allow patron types to be associated with account profiles and make uniqueness the combination of the patron type and account profile. (DIS-214) (*MDN*)
- Do not allow aspen_admin user to be deleted. (DIS-13) (*MDN*)
- Do not allow aspen_admin user to be edited by anyone other than the aspen_admin user. (DIS-13) (*MDN*)
- Allow the creation of objects using the editor to be done in two steps so that one property which controls other settings can be defined before the user is prompted for the dependent settings. (*MDN*) 
- Correct label for Search for a Property Control (*MDN*)
- If a field is read-only, do not change the value to blank when updating an object. (*MDN*) 
- When editing an object, properly display which fields are required and ensure the required attribute is set for the control. (DIS-293) (*MDN*)
- Add a new property type of dayMonth to allow selecting a date and month for a field. (DIS-291) (*MDN*)

<div markdown="1" class="settings">

#### New Settings
- Primary Configuration > Patron Types > Account Profile ID

</div>

### API Updates
- Add a new API to retrieve available sublocations for the system. (DIS-195) (*MDN*)
- API updates to support using multiple pickup areas within a location. (DIS-195) (*MDN*)
- When validating authentication tokens for LiDA, use the API keys within Branded App Settings if available, rather than validating against the Greenhouse. (DIS-270) (*MDN*)
- Correct critical warning for high wait time when checking site status. (*MDN*) 
- Correct returning Browse Category Title for Browse Categories created from Course Reserves. (*MDN*)
- Correct code formatting errors and define return types for methods. (*MDN*)

<div markdown="1" class="settings">

#### New Settings
- Aspen LiDA > Branded App Settings > API Keys

</div>

### Evergreen Updates
- Extend the timeout for loading reading history for Evergreen. (*MDN*)
- Properly handle titles that no longer exist within Evergreen when loading reading history for a patron. (*MDN*) 
- When importing lists from Evergreen, ensure that list entries have their titles set so the lists can be sorted by title. (*MDN*)
- Correct error when processing PIN Reset within Evergreen. (*MDN*)

### Indexing Profile Updates
- Add Indexing profiles in 2 steps. First set the name and indexing class and then set the remaining information. (DIS-230) (*MDN*)
- When creating an indexing profile, ensure that the name and record url component are unique and that the indexing profile is attached to an account profile. (DIS-230) (*MDN*)
- When creating indexing profiles, create default mappings for bibliographic and item information based on the selected indexing class. (DIS-230) (*MDN*)
- Reorganize Indexing Profile page to be easier to navigate. (DIS-230) (*MDN*)
- Display or hide fields within the Indexing Profile according to the ILS that the Indexing Profile is attached to. (DIS-230) (*MDN*)
- Remove unused Grouping Class and Record Driver Fields. (DIS-230) (*MDN*)

### Local Administrators
- Allow local administrators to be defined within Aspen. (DIS-13) (*MDN*)
- Local administrators must have a strong password from 12 to 50 characters. They may be created blank initially to force password reset. (DIS-13) (*MDN*)
- Local administrators may be given the ability to use Two-Factor Authentication if desired. (DIS-13) (*MDN*)
- Local administrators can reset their PIN/Password after logging in. (DIS-13) (*MDN*)
- Local administrators can utilize forgotten PIN/Password reset via email functionality. (DIS-13) (*MDN*)
- Local administrators are not allowed to link to other accounts and cannot be linked to from other accounts. (DIS-13) (*MDN*)
- Hide preference for *Show Checkouts and Holds in Results* for local administrators within My Preferences. (DIS-13) (*MDN*)
- Hide Contact Information for local administrators. (DIS-13) (*MDN*)

<div markdown="1" class="settings">

#### New Permissions
- System Administration > Manage Local Administrators

</div>

### Material Request Updates
- Allow some patron types to submit unlimited material requests. (DIS-256) (*MDN*)
- Allow requests per calendar year to be based on a start date selected by the library rather than using January 1st always. (DIS-291) (*MDN*)

<div markdown="1" class="settings">

#### New Settings
- Primary Configuration > Library Systems > Materials Request > Yearly Request Calendar Start Date

</div>

### Polaris Updates
- When loading patron types and libraries from Polaris, automatically associate them with the correct account profile. (DIS-214) (*MDN*)

### Record Display Updates
- When showing book summary (520), include $c in addition to $a. (DIS-236) (*MDN*)
- When showing notes for a MARC record, separate subfields with a space rather than a comma. (DIS-236) (*MDN*)

### Sideload Updates
- Remove unused Grouping Class and Record Driver Fields. (DIS-230) (*MDN*)

### Theme Updates
- Make the default Cover Image Style "Shadow / Floating" for new themes. (DIS-282) (*MDN*)

### Two-Factor Authentication
- Link Two-Factor Authentication to Account Profiles so local administrators can use Two-Factor Authentication. (DIS-13) (*MDN*)

### Other Updates
- Reformat template files to use tabs rather than spaces at the beginning of lines. (*MDN*) 
- Remove some old database updates that are now part of the standard default database. (DIS-237) (*MDN*)
- Streamline where Action.php is included. (DIS-247) (*MDN*)
- Allow Release Notes to be bookmarked. (DIS-255) (*MDN*)
- Correctly format the Date Scheduled and Date Run fields within the Scheduled Update Details popup. (*MDN*)
- Improve reliability of authenticating tokens for LiDA (DIS-269) (*MDN*)
- Make Download Supplemental File buttons translatable. (DIS-265) (*MDN*)
- While adding and editing sublocations, handle cases where the parent library is not attached to an account profile. (*MDN*)

//leo
### Indexing Updates
- Enhanced subtitle filtering for OverDrive records by ignoring the subtitle "number one bestseller". (DIS-211) (*LS*)

//leo
### Usage Tables Updates
- Added a unique composite index on `(userAgentId, year, month, instance)` for `usage_by_user_agent`. (DIS-250) (*LS*)
- Added update call in `bootstrap.php` to update IP Address request counter. (DIS-250) (*LS*)

//leo
### Instance Validation Updates
- Reorganized the user agent and IP address usage tracking, so it only runs once the instance is confirmed valid and found. (DIS-257) (*LS*)

//katherine

//kirstien

### Aspen LiDA Updates

- Added new setting to show/hide More Info button on the Grouped Work screen in Aspen LiDA. (DIS-207) (*KK*)

<div markdown="1" class="settings">

#### New Settings

- Aspen LiDA > General Settings > Show More Info button on Grouped Work Screen

</div>

### API Updates

- Add support for starting a Shared Session with LiDA to open a Grouped Work (DIS-207) (*KK*)

//james
### Carl.X Updates
- Add Lost items to Checked Out page (DIS-244) (*JStaub*)

### Circulation Reports Updates
- Nashville-only: Circulation Reports handle Aspen location codes in lower case when Carl.X branch codes are uppercase (DIS-312) (*JStaub*)

### Open Archives Updates
- Eliminate the time portion of display dates from Aspen Open Archives search results (DIS-242) (*JStaub*)

### Circulation Report Updates
- Nashville-only: Allow student checkout report to be filtered by library system (DIS-309) (*JStaub*)

### Other Updates
- Delete vestigial logging configuration (DIS-243) (*JStaub*)

//alexander
### Indexing Updates
- Add the option of only indexing records by the 856 field if the record does not have eContent items. (DIS-196) (*AB*)

### Web Builder Updates
- Add a message when saving a Grapes JS Template or Page to confirm it has been updated successfully. (DIS-92) (*AB*)

//imani
### Indexing Updates
- Created isOffline and quitIfOffline in SystemUtils to share common behavior across exporters (DIS-222) (*IT*)
- Changed existing offline checks in KohaExportMain to use SystemUtils instead. (DIS-222) (*IT*)
- Updated symphony exporter to check for offline mode and message and exit if enabled (DIS-222) (*IT*)
- Updated polaris exporter to check for offline mode and message and exit if enabled (DIS-222) (*IT*)
- Updated sierra exporter to check for offline mode and message and exit if enabled (DIS-222) (*IT*)
- Updated evergreen exporter to check for offline mode and message and exit if enabled (DIS-222) (*IT*)
- Updated carlx exporter to check for offline mode and message and exit if enabled (DIS-222) (*IT*)
- Updated evolve exporter to check for offline mode and message and exit if enabled (DIS-222) (*IT*)
- Removed unused isOffline from KohaExportMain. (DIS-222) (*IT*)

### Other Updates
- Added renew all, renew checked, and export to csv buttons to the top of the checkout list if 5 or more checkout items. (DIS-158) (*IT*)
- Update Koha importListFromILS to include the title on the created user_list_entry record. (DIS-225) (*IT*)
- Update UserListEntry to grab a title from the grouped work associated with its source ID if it is given no title and the grouped work is available. (DIS-225) (*IT*)
- Change substr to mb_substr in MyList.php BulkAddTitles when figuring out the title for the new user list entry (DIS-225) (*IT*)

//chloe
### Koha Integration Updates
- For libraries that use Koha as their ILS, and use the koha-plugin-newsletter-consent plugin
  - Administrator with the permission to edit library settings will be able to toggle on/off the 'Enable ILS-issued consents' setting under the 'Data Protection Regulations' section. (*CZ*)
    - if the Koha plugin has not been installed and enabled in Koha, then the 'Enable ILS-issued consents' setting will not appear as it requires the plugin to be installed and enabled. (*CZ*)
    - if the Koha plugin is uninstalled or disabled in Koha while 'Enable ILS-issued consents' is toggled on, 'Enable ILS-issued consents' will still display. (*CZ*)
  - If 'Enable ILS-issued consents' is enabled:
    - the 'Privacy Settings' options will appear in patron side menus. (*CZ*)
    - In the self-registration form, under a ‘Privacy’ section, patrons need to see information about the consent types set by their library in Koha. For example, they may be given the opportunity to receive the library’s newsletter. (*CZ*)
    - Patrons will be able to choose to opt in, which implies that consent is not assumed by default. (*CZ*)
    - Patrons will be able to submit their consent along with their registration form. (*CZ*)
    - Patrons will be sent to Koha, where it is stored. (*CZ*)
    - Patrons will be able to view and change their consent information (as retrieved from Koha) at any point through the ‘Your Account > Privacy Settings ’ section. (*CZ*)
    - If ILS consent is enabled in the Aspen settings, but the Koha plugin is disabled or uninstalled, patron will see an informative message in 'Privacy Settings'.  (*CZ*)

### WebBuilder Updates
- Fixed an issue preventing administrators from saving a 'URL to link image to' from the 'WebBuilder Portal Cells' page. (*CZ*)

//pedro

// lucas
### Docker Updates
- Fix : Add a environment variable useful for tunnel service (*LM*)

// tomas

// kyle

//kidclamp
### Other Updates
- Use mb_substr to preserve diacritics in lists (DIS-178) (*WNC*)

//yanjun

//lukeg

## This release includes code contributions from
### ByWater Solutions
  - Kyle Hall (KMH)
  - Lucas Gass (LG)
  - Nick Clemens (WNC)
  - Yanjun Li (YL)
  - Leo Stoyanov (LS)
  - Imani Thomas (IT)

### Grove For Libraries
  - Mark Noble (MDN)
  - Kirstien Kroeger (KK)
  - Katherine Perdue (KP)

### Nashville Public Library
  - James Staub (JStaub)

### PTFS-Europe
  - Alexander Blanchard (AB)
  - Chloe Zermatten (CZ)
  - Pedro Amorim (PA)

### Theke Solutions
  - Lucas Montoya (LM)
  - Tomás Cohen Arazi (TC)

## Special Testing thanks to
- Myranda Fuentes (Grove)
- Jordan Fields (Grove)

## Special Documentation thanks to
- Myranda Fuentes (Grove)
- Jordan Fields (Grove)

## This release includes sponsored developments from
- Greater Manchester Inter Library Consortial System (GMILCS)
- Metropolitan Library System
- Minuteman Library Network
- San Luis Obispo County Library
